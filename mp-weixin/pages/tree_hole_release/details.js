(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tree_hole_release/details"],{"27b6":function(e,t,r){"use strict";var o=r("8e76"),n=r.n(o);n.a},"8e76":function(e,t,r){},bd17:function(e,t,r){"use strict";r.r(t),function(e){r("6cdc"),r("66fd");var t=r("d3c4");wx.__webpack_require_UNI_MP_PLUGIN__=r,e(t["a"])}.call(this,r("543d")["createPage"])},d3c4:function(e,t,r){"use strict";var o,n={uniIcons:function(){return Promise.all([r.e("common/vendor"),r.e("components/uni-icons/uni-icons")]).then(r.bind(null,"2ba4"))}},i=function(){var e=this,t=e.$createElement,r=(e._self._c,e.$check_field("get","publish_users")),o=r?e.get_user_publish_users(e.obj["publish_users"]):null,n=e.$check_field("get","content_title"),i=e.$check_field("get","content_classification"),s=e.$check_field("get","image_content"),a=s?e.$fullUrl(e.obj["image_content"]):null,l=e.$check_field("get","video_content"),c=l&&e.obj["video_content"]?e.$fullUrl(e.obj["video_content"]):null,u=e.$check_field("get","text_content"),_=e.$check_action("/content_reporting/edit","add"),h=e.$check_action("/comment/list","add"),f=e.$check_action("/collect/list","add");e.$mp.data=Object.assign({},{$root:{m0:r,m1:o,m2:n,m3:i,m4:s,m5:a,m6:l,m7:c,m8:u,m9:_,m10:h,m11:f}})},s=[],a=r("e648"),l=a["a"],c=(r("27b6"),r("f0c5")),u=Object(c["a"])(l,i,s,!1,null,null,null,!1,n,o);t["a"]=u.exports},e648:function(e,t,r){"use strict";(function(e){var o=r("dc88");function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(O){c=function(e,t,r){return e[t]=r}}function u(e,t,r,o){var n=t&&t.prototype instanceof f?t:f,i=Object.create(n.prototype),s=new L(o||[]);return i._invoke=function(e,t,r){var o="suspendedStart";return function(n,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw i;return k()}for(r.method=n,r.arg=i;;){var s=r.delegate;if(s){var a=$(s,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var l=_(e,t,r);if("normal"===l.type){if(o=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o="completed",r.method="throw",r.arg=l.arg)}}}(e,r,s),i}function _(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(O){return{type:"throw",arg:O}}}e.wrap=u;var h={};function f(){}function d(){}function p(){}var m={};c(m,s,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(E([])));v&&v!==t&&r.call(v,s)&&(m=v);var y=p.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(i,s,a,l){var c=_(e[i],e,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==n(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){o("next",e,a,l)}),(function(e){o("throw",e,a,l)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,l)}))}l(c.arg)}var i;this._invoke=function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}}function $(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,$(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=_(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var n=o.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function E(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function t(){for(;++o<e.length;)if(r.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return d.prototype=p,c(y,"constructor",p),c(p,"constructor",d),d.displayName=c(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,o,n,i){void 0===i&&(i=Promise);var s=new w(u(t,r,o,n),i);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),c(y,l,"Generator"),c(y,s,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var o=t.pop();if(o in e)return r.value=o,r.done=!1,r}return r.done=!0,r}},e.values=E,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(r,o){return s.type="throw",s.arg=e,t.next=r,o&&(t.method="next",t.arg=void 0),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(a&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var o=r.completion;if("throw"===o.type){var n=o.arg;x(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function s(e,t,r,o,n,i,s){try{var a=e[i](s),l=a.value}catch(c){return void r(c)}a.done?t(l):Promise.resolve(l).then(o,n)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){s(i,o,n,a,l,"next",e)}function l(e){s(i,o,n,a,l,"throw",e)}a(void 0)}))}}var l=function(){r.e("components/diy/list_comment").then(function(){return resolve(r("0ff7"))}.bind(null,r)).catch(r.oe)},c=function(){r.e("components/diy/bar_title").then(function(){return resolve(r("a3ca"))}.bind(null,r)).catch(r.oe)},u=function(){r.e("components/diy/form_editor").then(function(){return resolve(r("56c9"))}.bind(null,r)).catch(r.oe)};t["a"]={mixins:[o["a"]],components:{list_comment:l,bar_title:c,form_editor:u},data:function(){return{url_get_obj:"~/api/tree_hole_release/get_obj?",field:"tree_hole_release_id",query:{tree_hole_release_id:0},obj:{publish_users:0,content_title:"",content_classification:"",image_content:"",video_content:"",text_content:"",hits:0,praise_len:0,tree_hole_release_id:0},praise:0,state_praise:!1,collect:0,state_collect:!1,list_comment:[],bar_title:"评论区",bar_url:"",list_user_publish_users:[]}},methods:{openUrl:function(t){console.log(1111),e.navigateTo({url:"/pages/webview/webview?url=".concat(t)})},get_praise:function(e){var t=this,r=this.user.user_id;this.$get("~/api/praise/count?",{source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:e["tree_hole_release_id"]},(function(e){e.result||0===e.result?(t.praise=e.result,console.log("点赞数：",e.result)):e.error&&(t.$toast(e.error.message),console.error(e.error))})),this.$get("~/api/praise/count?",{source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:e["tree_hole_release_id"],user_id:r},(function(e){e.result||0===e.result?(t.state_praise=!!e.result,console.log("点赞状态：",e.result)):e.error&&(t.$toast(e.error.message),console.error(e.error))}))},change_praise:function(e){var t=this,r=this.user.user_id,o={source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:this.obj["tree_hole_release_id"],user_id:r},n=this;n.obj.praise_len=parseInt(n.obj.praise_len),this.state_praise?(this.state_praise=!1,this.$get("~/api/praise/del?",o,(function(e){if(e.result){var r=n.obj.praise_len-1;t.$post("~/api/tree_hole_release/set?tree_hole_release_id="+n.obj["tree_hole_release_id"],{praise_len:r},(function(e){e.result?(n.obj.praise_len=r,console.log("添加点赞数状态：",e.result)):e.error&&console.error(e.error)})),t.$toast("取消点赞")}else e.error&&(t.$toast(e.error.message),console.error(e.error))}))):(this.state_praise=!0,this.$post("~/api/praise/add?",o,(function(e){if(e.result){var r=n.obj.praise_len+1;t.$post("~/api/tree_hole_release/set?tree_hole_release_id="+n.obj["tree_hole_release_id"],{praise_len:r},(function(e){e.result?(n.obj.praise_len=r,console.log("添加点赞数状态：",e.result)):e.error&&console.error(e.error)})),t.$toast("点赞成功")}else e.error&&(t.$toast(e.error.message),console.error(e.error))})))},get_collect:function(e){var t=this,r=this.user.user_id,o={source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:e["tree_hole_release_id"],user_id:r};this.$get("~/api/collect/count?",o,(function(e){if(console.log(e),e.result||0===e.result){var r=!!e.result;t.state_collect=r,console.log("收藏状态："+r)}else e.error&&console.error(e.error)}))},change_collect:function(){var e=this,t=this.user.user_id,r={source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:this.obj["tree_hole_release_id"],user_id:t};this.state_collect?(this.state_collect=!1,this.$get("~/api/collect/del?",r,(function(t){t.result?e.$toast("取消收藏"):t.error&&(e.$toast(t.error.message),console.error(t.error))}))):(this.state_collect=!0,r.title=this.obj.content_title,r.img=this.obj.image_content,this.$post("~/api/collect/add?",r,(function(t){t.result?e.$toast("收藏成功"):t.error&&(e.$toast(t.error.message),console.error(t.error))})))},get_comment:function(e){var t=this,r={source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:e["tree_hole_release_id"],orderby:"create_time desc",reply_to_id:"0"};this.$get(getApp().globalData.host+"/api/comment/get_list?",r,(function(r){if(r.result){var o=r.result.list;o.map((function(e){e.list_reply=[]})),t.add_reply(e,o).then((function(e){t.list_comment=e}))}}))},add_reply:function(e,t){var r=this;return new Promise((function(e){for(var o=function(e){var o=t[e];r.$get(getApp().globalData.host+"/api/comment/get_list?",{source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:o["tree_hole_release_id"],orderby:"create_time desc",reply_to_id:o.comment_id},(function(e){e.result&&(o.list_reply=e.result.list)}))},n=0;n<t.length;n++)o(n);e(t)})).catch((function(e){}))},add_hits:function(e){var t=this;e["hits"]=e["hits"]+1;var r=e["hits"];this.$post("~/api/tree_hole_release/set?tree_hole_release_id="+e["tree_hole_release_id"],{hits:r},(function(e){if(e.result){console.log("添加访问量状态：",e.result);var r={source_table:"tree_hole_release",source_field:"tree_hole_release_id",source_id:t.obj.tree_hole_release_id,user_id:t.$store.state.user.user_id};t.$post("~/api/hits/add?",r,(function(e){console.log(e)}))}else e.error&&console.error(e.error)}))},get_obj_after:function(e){if(this.obj){var t=this.obj;this.get_praise(t),this.get_collect(t),this.get_comment(t),this.add_hits(t)}},get_list_user_publish_users:function(){var e=this;return a(i().mark((function t(){var r;return i().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("~/api/user/get_list?user_group=注册用户");case 2:r=t.sent,r.result&&r.result.list?e.list_user_publish_users=r.result.list:r.error&&console.error(r.error);case 4:case"end":return t.stop()}}),t)})))()},get_user_publish_users:function(e){for(var t=this.list_user_publish_users,r="",o=0;o<t.length;o++)t[o].user_id==e&&(r=t[o].nickname+"-"+t[o].username);return r}},created:function(){this.get_list_user_publish_users()},mounted:function(){}}}).call(this,r("543d")["default"])}},[["bd17","common/runtime","common/vendor"]]]);